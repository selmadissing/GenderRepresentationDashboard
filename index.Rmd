---
title: "WOMEN IN MUSIC"
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    theme: journal
    css: style.css
    self_contained: false
---

```{r setup, include = FALSE}
library(flexdashboard)
library(shiny)
library(jsonlite)
library(maptools)
library(ggplot2)
library(tidyr)
library(dplyr)
library(purrr)
library(leaflet)
library(plotly)
library(forcats)
library(RColorBrewer)
library(waffle)

wide <- read.csv("wide.csv")
long <- read.csv("long.csv")
averages <- read.csv("AveragePerQuestionPerSong.csv")
averages_both <- read.csv("AveragePerQuestionPerSongBoth.csv")

adding_attitude <- wide %>% 
  group_by(condition) %>%
  mutate(attitude=(Q1+Q2+Q3+Q4+Q5+Q6+Q7)/7)

genderrepMale <- wide %>%
  filter(gender=="Male") %>%
  count(genderrep) %>%
  mutate(Freq = n/sum(n)*100) %>%
  mutate(Gender = "Male")

genderrepFemale <- wide %>%
  filter(gender=="Female") %>%
  count(genderrep) %>%
  mutate(Freq = n/sum(n)*100) %>%
  mutate(Gender = "Female")

genderrep <- rbind(genderrepMale,genderrepFemale) 
```


Introduction
======================================================

Column {data-width=185}
-----------------------------------------------------------------------

### Introduction 
<p style="font-size:13px;">Gender representation should be considered across all professional fields, and the music industry is not an exception. Despite the fact that there are definitely female music superstars, the music industry remains a place with not much female representation (Bernabé-Villodre et al., 2018). Female artists are seen changing their public image, transitioning from one “era” in their career to another to stay relevant, whilst that is rarely the case for male artists. The dopamine-stimulatory threshold among listeners is lower for male music artists rather than female music artists, as male artists can stay in the same genre for ages and still stay desirable. Furthermore, 98% of producers in the music industry are male (Statista, 2021).<br>
<br>
Despite the aforementioned information, the lack of gender representation remains a mystery to many, due to the fact some of the loudest musicians are female. However, that is not the case for all levels of fame, and our study aims to investigate attitude towards gender representation in the music industry, following exposure to songs with a feminist tone. We also want to see whether the attitude would be different among men and women. Therefore, the following research question was formulated:<br>
<br>
RQ: To what extent is the attitude towards gender representation in the music industry predicted by tone of the song and moderated by gender?</p>

### Motivation
<i>Ellie</i><br>
<p style="font-size:13px;">The power of music lyrics is one that has always had quite an effect on me and my mood in many ways. I have always had specific songs that I refer to for whatever mood I’m in because the lyrics hold a certain power to change my mood or mindset. Feminist lyrics often carry an important message for all people to hear, not just women- I wanted to see if everyone listened!</p>

<i>Roos</i><br>
<p style="font-size:13px;">bla bla bla</p>

<i>Selma</i><br>
<p style="font-size:13px;">The way a message can be forwarded through music lyrics 
</p>
<i>Sonya</i><br>
<p style="font-size:13px;">From an early age, I have been actively seeking every opportunity to tie music into my life: I have been playing various musical instruments and singing, participating in numerous talent shows and school musicals, attending concerts, volunteering as a music teacher at an orphanage in Vietnam, and collaborating with my friends on musical production. Growing up abroad and having to navigate through life in a country that’s my own but not entirely, made me rely more heavily on music - a universal language. The Data Science of Everyday Music Listening has transformed my intuitive understanding of music into an empirical and academic understanding of it, which has been enlightening.</p>



Column {data-width=500}
-----------------------------------------------------------------------
### Attitude difference

```{r}
ggplot(adding_attitude, aes(x = gender, y=attitude, fill = gender)) +
  geom_bar(position="dodge", stat="identity") + facet_grid(. ~ condition) +
  labs(
    x = "Gender",
    y = "Attitude") +
  scale_fill_manual(name="Gender", values=c("#F25C54", "#F7B267")) +
  theme_bw() + 
    theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black"))
```



Column {.tabset data-width=175}
-----------------------------------------------------------------------

### Feminist

<iframe src="https://open.spotify.com/embed/playlist/7mWbXdE4Hky7MIt8BOjryX?utm_source=generator" width="100%" height="100%" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

### Neutral

<iframe src="https://open.spotify.com/embed/playlist/2ttgDPSxCi9oPbOEQCrLvl?utm_source=generator" width="100%" height="100%" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>



Results
======================================================
Column {.tabset data-width=800}
-----------------------------------------------------------------------
### Enjoyment

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q1, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + 
  labs(
    x = "",
    y = "",
    title = "Explanation",
    subtitle = " (Q1) I enjoyed the lyrics of this excerpt") +
  scale_fill_manual(values=c("#ff6699", "#93C54B")) +
  theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black")) +
   scale_y_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("Strongly Disagree", "", "", "", "", "", "Strongly Agree"), limits=c(0,8))
```

### Equality

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q2, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() +
  labs(
    x = "",
    y = "",
    title = "Explanation",
    subtitle = " (Q2) I think these lyrics represented \n men and/or women fairly") + scale_fill_manual(values=c("#ff6699", "#93C54B")) +
  theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black")) +
   scale_y_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("Strongly Disagree", "", "", "", "", "", "Strongly Agree"), limits=c(0,8))

```

### Representation

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q3, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() +
  labs(
    x = "",
    y = "",
    title = "Explanation",
    subtitle = " (Q3) After listening to this excerpt, I feel positively \n about gender representation in music") + scale_fill_manual(values=c("#ff6699", "#93C54B")) +
  theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black")) +
  scale_y_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("Strongly Disagree", "", "", "", "", "", "Strongly Agree"), limits=c(0,8))
```

### Included

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q4, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() +
  labs(
    x = "",
    y = "",
    title = "Explanation",
    subtitle = " (Q4) I feel represented in the lyrics I just heard") + scale_fill_manual(values=c("#ff6699", "#93C54B")) +
  theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black")) + 
  scale_y_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("Strongly Disagree", "", "", "", "", "", "Strongly Agree"), limits=c(0,8))
```

### Message

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q5, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() +
  labs(
    x = "",
    y = "",
    title = "Explanation",
    subtitle = " (Q5) These lyrics create a positive message") + scale_fill_manual(values=c("#ff6699", "#93C54B")) +
  theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black")) +
  scale_y_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("Strongly Disagree", "", "", "", "", "", "Strongly Agree"), limits=c(0,8))
```

### Uncomfortableness

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q6, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() +
  labs(
    x = "",
    y = "",
    title = "Explanation",
    subtitle = " (Q6) These lyrics make me feel uncomfortable") + scale_fill_manual(values=c("#ff6699", "#93C54B")) +
  theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black")) +
  scale_y_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("Strongly Disagree", "", "", "", "", "", "Strongly Agree"), limits=c(0,8))
```

### Connotations

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q7, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() +
  labs(
    x = "",
    y = "",
    title = "Explanation",
    subtitle = " (Q7) This excerpt had feminist connotations in its lyrics") + scale_fill_manual(values=c("#ff6699", "#93C54B")) +
  theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 10, color="black"),
    axis.text=element_text(color="black")) +
  scale_y_continuous(breaks=c(1, 2, 3, 4, 5, 6, 7), labels=c("Strongly Disagree", "", "", "", "", "", "Strongly Agree"), limits=c(0,8))
```

Column {data-width=200}
-----------------------------------------------------------------------
### Explanation


Methods
======================================================

Column
-----------------------------------------------------------------------

### Infographics, materials and procedure
<p style="font-size:"10px">Men and women are equally represented in music today</p>
```{r figures-side, fig.show="hold", out.width="50%"}

myPalette <- brewer.pal(7, "RdYlGn") 

ggplot(genderrepMale, aes(fill = genderrep, values = Freq)) +
  geom_waffle(n_rows = 10, size = 0.33, colour = "white") +
  scale_fill_manual(name = NULL,
                    values = myPalette,
                    labels = c("Strongly Disagree","Disagree","Somewhat disagree","Neither agree nor disagree","Somewhat agree", "Agree", "Strongly Agree")) + coord_equal() + theme_void() +labs(title = "Male")

ggplot(genderrepFemale, aes(fill = genderrep, values = Freq)) +
  geom_waffle(n_rows = 10, size = 0.33, colour = "white") +
  scale_fill_manual(name = NULL,
                    values = myPalette,
                    labels = c("Strongly Disagree","Disagree","Somewhat disagree","Neither agree nor disagree","Somewhat agree", "Agree", "Strongly Agree")) +
  coord_equal() +
  theme_void() +
  labs(
    title = "Female"
  )

```

### Infographics, materials and procedure
```{r}
ggplot(genderrep, aes(x=genderrep, y=Freq, fill=Gender)) +
  geom_bar(position="dodge", stat="identity", width=.5) + 
  labs(
    x = "",
    y = "Percentage",
    title = "Men and women are equally represented in music today") +
  scale_fill_manual(values=c("#ffcc66", "#ff6666")) +
  theme_bw() + 
    theme(
    text = element_text(family = "Palatino", size = 10, color="black")) +
  scale_x_continuous(breaks=c(1,2,3, 4, 5, 6, 7), labels = c("Strongly Disagree","Disagree","Somewhat disagree","Neither agree nor disagree","Somewhat agree", "Agree", "Strongly Agree"), limits=c(0,8)) + 
  theme(axis.text.x=element_text(color="black",angle=30, vjust=.8, hjust=0.8))
```

Column 
-----------------------------------------------------------------------
###
<div style="position: relative; width: 100%; height: 0; padding-top: 133.3333%;
 padding-bottom: 48px; margin-top: 1.6em; margin-bottom: 0.9em; overflow: hidden;
 border-radius: 8px; will-change: transform;">
  <iframe loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;margin: 0;"
    src="https:&#x2F;&#x2F;www.canva.com&#x2F;design&#x2F;DAE3IlLVzP0&#x2F;view?embed" allowfullscreen="allowfullscreen" allow="fullscreen">
  </iframe>
</div>

Evaluations
======================================================
Column
-----------------------------------------------------------------------

### Conclusion

```{r}

```

Column
-----------------------------------------------------------------------

### Limitations
<b>Sample</b>:<br>
<i>Gender distribution</i>:<br>
The total sample contained entries from 99 women, 63 men and 8 non-binary people. Because of the low amount of non-binary respondents, these entries were not taken into account in the final sample. Because of this, the results only show comparisons of people that identify within the traditional gender binary. This does not show a complete picture of the actual population and is an interesting topic to explore within future research.<br>
After filtering for unusable entries, entries from 98 women and 57 men remained. These amounts differ from each other quite a bit but are compared within our analysis regardless. The difference in sample size could possibly act as a confounder and be responsible for some of the found differences in attitude.<br>
<br>
<i>Mostly European participants</i>:<br>
When asked about their continent of origin, by far the most participants (137) responded with Europe. The found results are thus not applicable for all countries or cultures, but mostly for Western countries.<br>
<br>
<b>Survey</b>:<br>
<i>English proficiency</i>:<br>
Because we did not ask the participants about their level of English, we have no way to control this. A considerable amount of our survey refers to the interpretation of song lyrics, so if these lyrics are not understood correctly this might have influenced the results.<br>
<br>
<i>Actual listening</i>:<br>
Within Qualtrics, there is no way to check if a participant has actually listened to the song excerpt, and has read the lyrics.


### Further Research
1. Predisposition<br>
Investigate someone’s existing predisposition towards feminism/gender representation as a predictor of their attitude toward gender representation in the music industry (post exposure to feminist-toned songs).<br>
<br>
2. Priming<br> 
Priming participant with facts about gender representation (not just in the music industry, but in general), before exposure to the feminist-tones song or the control-condition song. Investigate whether priming would influence the participant’s attitude towards gender representation in the music industry.

