---
title: "WOMEN IN MUSIC"
output:
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
    #source_code: embed
    theme: journal
    #css: style.css
    self_contained: false
---

```{r setup, include = FALSE}
library(flexdashboard)
library(shiny)
library(jsonlite)
library(maptools)
library(ggplot2)
library(tidyr)
library(dplyr)
library(purrr)
library(leaflet)
library(plotly)
library(forcats)

wide <- read.csv("wide.csv")
long <- read.csv("long.csv")
averages <- read.csv("AveragePerQuestionPerSong.csv")

new <- wide %>% 
  mutate(attitude=(Q1+Q2+Q3+Q4+Q5+Q6+Q7)/7)








```




Main Findings
======================================================

Column {.tabset data-width=161}
-----------------------------------------------------------------------

### Feminist

Maybe some nice text about the feminist songs 

<iframe src="https://open.spotify.com/embed/playlist/7mWbXdE4Hky7MIt8BOjryX?utm_source=generator" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

### Neutral

Maybe some nice text about the neutral songs

<iframe src="https://open.spotify.com/embed/playlist/2ttgDPSxCi9oPbOEQCrLvl?utm_source=generator" width="100%" height="380" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>

Column {.tabset data-width=500}
-----------------------------------------------------------------------

### Q1

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q1, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + xlab("") + ylab("Scale") + theme_bw() + ylim(0,6) + ggtitle("I enjoyed the lyrics of this excerpt")
```

### Q2

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q2, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + xlab("") + ylab("Scale") + theme_bw() + ylim(0,6) + ggtitle("I think these lyrics represented \n men and/or women fairly")

```

### Q3

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q3, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + xlab("") + ylab("Scale") + theme_bw()  + ylim(0,6) + ggtitle("After listening to this excerpt, I feel positively \n about gender representation in music")
```

### Q4

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q4, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + xlab("") + ylab("Scale") + theme_bw()  + ylim(0,6) + ggtitle("I feel represented in the lyrics I just heard")
```

### Q5

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q5, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + xlab("") + ylab("Scale") + theme_bw()  + ylim(0,6) + ggtitle("These lyrics create a positive message")
```

### Q6

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q6, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + xlab("") + ylab("Scale") + theme_bw()  + ylim(0,6) + ggtitle("These lyrics make me feel uncomfortable")
```

### Q7

```{r}
averages %>%
  mutate(Song = fct_reorder(Song, desc(Order))) %>%
  ggplot(aes(x=Song, y=Q7, fill=Condition)) + geom_col(stat="identity", width=.4) + coord_flip() + xlab("") + ylab("Scale") + theme_bw()  + ylim(0,6) + ggtitle("This excerpt had feminist connotations in its lyrics")
```


Column {data-width=350}
-----------------------------------------------------------------------

### Chart C

```{r}
wide %>% 
  ggplot(aes(x = genderrepimportant, colour=age)) +
  geom_histogram(binwidth = 0.2)
```

### Chart Dooo

```{r}


```

Data
======================================================

Column
-----------------------------------------------------------------------

### Chart D

```{r }
```

Literature
======================================================

Column
-----------------------------------------------------------------------

### Chart D

```{r}

```

